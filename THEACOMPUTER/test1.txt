# Heterocystic model

graphics opengl_better

light room ambient 0 0 0
light 0 position 10 4000 2000
light 0 diffuse 1 0.5 0.5
light 0 ambient 0.1 0.1 0.1
light 0 specular 1 1 1

dim 3
species Ci Ngas Ogas Cfix Nfix ATP			

time_start 0
time_stop 17280
time_step 1

color Cfix green
color Ngas pink	
color Ci blue
color Nfix red
color Ogas cyan
color ATP yellow

display_size ATP 2
display_size Nfix 3
display_size Cfix 3
display_size Ci 1
display_size Ngas 1
display_size Ogas 1

boundaries x -800 800 r  
boundaries y -150 150  r
boundaries z -150 150 r
frame_thickness 0

start_surface boundary
action all both reflect
color both darkgrey 1
polygon both edge
panel rect +0 -800 -150 150 300 -300
panel rect -0 800 -150 150 300 -300
panel rect +1 -800 -150 150 1600 -300
panel rect -1 -800 150 150 1600 -300
panel rect +2 -800 -150 150 1600 300
panel rect -2 -800 -150 -150 1600 300
end_surface 

start_surface filament
action all both transmit
rate Nfix bsoln fsoln 0.2
rate Cfix bsoln fsoln 0.2
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.8
rate Ngas bsoln fsoln 0.8
rate Ogas bsoln fsoln 0.8
color both darkgrey 
shininess both 20
polygon both edge
panel hemi -580 0 0 70 1 0 0 10 4	
panel cyl -580 0 0 595 0 0 70 10 20
panel hemi 595 0 0 70 -1 0 0 10 4
end_surface

start_compartment Cfilament
surface filament
point 0 60 0
end_compartment

start_surface cellmembrane_1
action all both transmit
rate Nfix bsoln fsoln 0.8
rate Cfix bsoln fsoln 0.4
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.9
rate Ngas bsoln fsoln 0.9
rate Ogas bsoln fsoln 0.9
color both green 1
polygon both edge
panel sph -580 0 0 50 20 20
end_surface

start_surface cellmembrane_2
action all both transmit
rate Nfix bsoln fsoln 0
rate Cfix bsoln fsoln 0
rate ATP bsoln fsoln 0
rate Ci bsoln fsoln 0.1
rate Ngas bsoln fsoln 0.3
rate Ogas bsoln fsoln 0.1 
color both darkorange 1
polygon both edge
panel sph -475 0 0 50 20 20
panel cyl -525 0 0 -530 0 0 2 10 3
panel cyl -420 0 0 -425 0 0 2 10 3
end_surface

start_surface jumpsurface_123
action both all jump
color both blue
polygon both edge
panel disk -535 0 0 15 1 0 0 10 c1b
panel disk -520 0 0 15 1 0 0 10 c2a
panel disk -430 0 0 15 1 0 0 10 c2b
panel disk -415 0 0 15 1 0 0 10 c3a
jump c1b back <-> c2a front
jump c2b back <-> c3a front
end_surface

start_surface cellmembrane_3
action all both transmit
rate Nfix bsoln fsoln 0.8
rate Cfix bsoln fsoln 0.4
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.9
rate Ngas bsoln fsoln 0.9
rate Ogas bsoln fsoln 0.9
color both green 1
polygon both edge
panel sph -370 0 0 50 20 20
end_surface

start_surface cellmembrane_4
action all both transmit
rate Nfix bsoln fsoln 0.8
rate Cfix bsoln fsoln 0.4
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.9
rate Ngas bsoln fsoln 0.9
rate Ogas bsoln fsoln 0.9
color both green 1
polygon both edge
panel sph -265 0 0 50 20 20
end_surface

start_surface cellmembrane_5
action all both transmit 
rate Nfix bsoln fsoln 0.8
rate Cfix bsoln fsoln 0.4
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.9
rate Ngas bsoln fsoln 0.9
rate Ogas bsoln fsoln 0.9
color both green 1
polygon both edge
panel sph -160 0 0 50 20 20
end_surface

start_surface cellmembrane_6
action all both transmit
rate Nfix bsoln fsoln 0.8
rate Cfix bsoln fsoln 0.4
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.9
rate Ngas bsoln fsoln 0.9
rate Ogas bsoln fsoln 0.9
colour both green 1
polygon both edge
panel sph -55 0 0 50 20 20
end_surface

start_surface cellmembrane_7
action all both transmit
rate Nfix bsoln fsoln 0.8
rate Cfix bsoln fsoln 0.4
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.9
rate Ngas bsoln fsoln 0.9
rate Ogas bsoln fsoln 0.9 
color both green 1
polygon both edge
panel sph 50 0 0 50 20 20
end_surface

start_surface cellmembrane_8
action all both transmit
rate Nfix bsoln fsoln 0.8
rate Cfix bsoln fsoln 0.4
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.9
rate Ngas bsoln fsoln 0.9
rate Ogas bsoln fsoln 0.9
color both green 1
polygon both edge
panel sph 155 0 0 50 20 20
end_surface

start_surface cellmembrane_9
action all both transmit
rate Nfix bsoln fsoln 0.8
rate Cfix bsoln fsoln 0.4
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.9
rate Ngas bsoln fsoln 0.9
rate Ogas bsoln fsoln 0.9
color both green 1
polygon both edge
panel sph 260 0 0 50 20 20
end_surface

start_surface cellmembrane_10
action all both transmit
rate Nfix bsoln fsoln 0
rate Cfix bsoln fsoln 0
rate ATP bsoln fsoln 0
rate Ci bsoln fsoln 0.1
rate Ngas bsoln fsoln 0.3
rate Ogas bsoln fsoln 0.1 
color both darkorange 1
polygon both edge
panel sph 365 0 0 50 20 20
panel cyl 415 0 0 420 0 0 2 10 3
panel cyl 315 0 0 310 0 0 2 10 3
end_surface

start_surface jumpsurface_91011
action both all jump
color both blue
polygon both edge
panel disk +305 0 0 15 1 0 0 10 c9b
panel disk +320 0 0 15 1 0 0 10 c10a
panel disk +410 0 0 15 1 0 0 10 c10b
panel disk +425 0 0 15 1 0 0 10 c11a
jump c9b back <-> c10a front
jump c10b back <-> c11a front
end_surface

start_surface cellmembrane_11
action all both transmit
rate Nfix bsoln fsoln 0.8
rate Cfix bsoln fsoln 0.4
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.9
rate Ngas bsoln fsoln 0.9
rate Ogas bsoln fsoln 0.9
color both green 1
polygon both edge
panel sph 470 0 0 50 20 20
end_surface

start_surface cellmembrane_12
action all both transmit
rate Nfix bsoln fsoln 0.8
rate Cfix bsoln fsoln 0.4
rate ATP bsoln fsoln 0.1
rate Ci bsoln fsoln 0.9
rate Ngas bsoln fsoln 0.9
rate Ogas bsoln fsoln 0.9
color both green 1
polygon both edge
panel sph 575 0 0 50 20 20
end_surface

start_compartment cytoplasm_1
surface cellmembrane_1
point -575 0 0
end_compartment

start_compartment cytoplasm_2
surface cellmembrane_2
point -470 0 0
end_compartment

start_compartment cytoplasm_3
surface cellmembrane_3
point -365 0 0
end_compartment

start_compartment cytoplasm_4
surface cellmembrane_4
point -260 0 0
end_compartment

start_compartment cytoplasm_5
surface cellmembrane_5
point -155 0 0
end_compartment

start_compartment cytoplasm_6
surface cellmembrane_6
point -50 0 0
end_compartment

start_compartment cytoplasm_7
surface cellmembrane_7
point 50 0 0
end_compartment

start_compartment cytoplasm_8
surface cellmembrane_8
point 155 0 0
end_compartment

start_compartment cytoplasm_9
surface cellmembrane_9
point 260 0 0
end_compartment

start_compartment cytoplasm_10
surface cellmembrane_10
point 365 0 0
end_compartment

start_compartment cytoplasm_11
surface cellmembrane_11
point 470 0 0
end_compartment

start_compartment cytoplasm_12
surface cellmembrane_12
point 575 0 0
end_compartment

start_compartment boundary 
surface boundary
point 100 100 100
end_compartment

start_compartment filament 
surface filament
point 10 0 0 
end_compartment

start_compartment extracellular
surface cellmembrane_1
surface cellmembrane_2
surface cellmembrane_3
surface cellmembrane_4
surface cellmembrane_5
surface cellmembrane_6
surface cellmembrane_7
surface cellmembrane_8
surface cellmembrane_9
surface cellmembrane_10
surface cellmembrane_11
surface cellmembrane_12
surface boundary
point 0 100 0
point 0 -100 0
point 0 0 -100
point 0 0 100
end_compartment

start_compartment intracellular
surface cellmembrane_1
surface cellmembrane_2
surface cellmembrane_3
surface cellmembrane_4
surface cellmembrane_5
surface cellmembrane_6
surface cellmembrane_7
surface cellmembrane_8
surface cellmembrane_9
surface cellmembrane_10
surface cellmembrane_11
surface cellmembrane_12 
point -580 0 0
point -475 0 0   
point -370 0 0 
point -265 0 0 
point -160 0 0 
point -55 0 0 
point 50 0 0 
point 155 0 0 
point 260 0 0
point 365 0 0 
point 470 0 0 
point 575 0 0 
end_compartment

start_compartment vegetative
surface cellmembrane_1
surface cellmembrane_3
surface cellmembrane_4
surface cellmembrane_5
surface cellmembrane_6
surface cellmembrane_7
surface cellmembrane_8
surface cellmembrane_9
surface cellmembrane_11
surface cellmembrane_12
point -580 0 0 
point -370 0 0 
point -265 0 0 
point -160 0 0 
point -55 0 0 
point 50 0 0 
point 155 0 0 
point 260 0 0 
point 470 0 0 
point 575 0 0 
end_compartment

start_compartment heterocyst 
surface cellmembrane_2
surface cellmembrane_10
point 365 0 0 
point -475 0 0 
end_compartment

compartment_mol 40000 Nfix filament
compartment_mol 0 Cfix intracellular

cmd i 0 17280 2160 killmolincmpt ATP extracellular
cmd i 0 17280 2160 killmolincmpt Cfix extracellular
cmd i 0 17280 2160 killmolincmpt Nfix extracellular

difc Nfix 0
difc Cfix 0
difc Ogas 0
difc Ngas 0
difc Ci 0
difc ATP 0

reaction_cmpt vegetative photosynthesis		Ci -> Cfix + Ogas
reaction_cmpt intracellular respiration		Cfix + Ogas -> Ci + ATP	+ ATP + ATP 
reaction_cmpt heterocyst Nfixation 		Ngas + ATP -> Nfix 			
reaction_cmpt intracellular protein_turnover 	Nfix -> Ngas
product_placement photosynthesis irrev	
product_placement respiration irrev
product_placement Nfixation irrev
product_placement protein_turnover irrev

reaction_rate photosynthesis 0
reaction_rate respiration 0
reaction_rate Nfixation 0
reaction_rate protein_turnover 0

cmd @ 4680 set reaction_rate photosynthesis 0
cmd @ 8640 set reaction_rate photosynthesis 0.01
cmd @ 13320 set reaction_rate photosynthesis 0

cmd @ 0 set background_color 1 1 1 
cmd @ 4680 set background_color grey
cmd @ 8640 set background_color 1 1 1 
cmd @ 13320 set background_color grey


end_file
